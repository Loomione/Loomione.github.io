---
title: Golang 学习笔记
tags: Golang
aside:
  toc: true
---

博主之前使用的语言主要是C++，目前想要学习一下Golang，这篇文章主要是记录一下Golang和C++基础语法的一些区别。

<!--more-->


## 1. Golang 简介


## 2. Golang 基础语法

### 2.1. 行分隔符

Golang 使用`换行符`作为行分隔符，而C++使用分号作为行分隔符。

- 如果打算将多个语句写在同一行，可以使用分号作为语句之间的分隔符。
- 如果一行的长度超过了编辑器的显示范围，可以使用反斜杠 `\` 作为换行符。

```go
fmt.Println("Hello, World!")

fmt.Println("Hello, World!"); fmt.Println("Hello, World!")

fmt.Println(" \
    Hello, World! \ 
")
```

```cpp
std::cout << "Hello, World!" << std::endl;
```

### 2.2. 注释

Golang 和 C++ 都支持单行注释和多行注释，语法也都一样。


### 2.3. 包

Golang 程序是通过包（package）来组织的，包类似于其它编程语言中的库（library）或模块（module）的概念。一个包可以包含多个文件，一个文件夹下的所有文件都属于同一个包。

在C++中，我们使用 `#include` 来引入头文件，而在Golang中，我们使用 `import` 来引入包。

```go
import "fmt"
```

```cpp
#include <iostream>
```

另外，在Golang中，可以使用 `import 圆括号`引入多个包，如下所示：

```go
import (
    "fmt"
    "math"
)
```

上面的代码中，我们引入了 `fmt` 和 `math` 两个包。这个写法等价于：

```go
import "fmt"
import "math"
```

导出名
: 在 Golang 中，如果一个标识符以大写字母开头，那么它就是导出的（public）。在导入一个包时，你只能引用其中已导出的名字。任何“未导出”的名字在该包外均无法访问。

### 2.4. 函数

- Golang 的函数需要用关键字`func`声明，而C++中的函数不需要关键字声明。
- Golang 中参数的类型在变量名之后，与变量名之间用空格隔开，这里和C++有所不同。
  - 当两个或多个连续的函数命名参数具有相同的类型时，除最后一个类型之外，其他类型可以**省略**。
- Golang 函数的返回值类型在参数列表之后，与参数列表之间用空格隔开，C++11也支持这种尾置返回类型的写法，不过参数类型和参数列表之间用箭头 `->` 隔开，在C++17中，可以使用 `auto` 关键字代替返回值类型。
  
```go
func add(x int, y int) int {
    return x + y
}

func add(x, y int) int { // 省略了 y 的类型
    return x + y
}
```

```cpp
auto add(int x, int y) -> int {
    return x + y;
}
```
- Golang 函数可以返回多个值，而C++中只能返回一个值（但C++中可以使用 `std::tuple` 或 `std::pair` 来实现这样的效果）。
  - Golang 中的多返回值使用圆括号括起来。
  
```go
func swap(x, y string) (string, string) {
    return y, x
}
```

命名返回值
: Golang 允许命名返回值，这种情况下，函数的返回值就会被视为定义在函数顶部的变量。这种情况下，函数的返回值可以被看作是函数的局部变量。

```go
func split(sum int) (x, y int) {
    x = sum * 4 / 9
    y = sum - x
    return
}
```

### 2.5. 变量

- Golang 中的变量声明格式为 `var <变量名> <变量类型>`，而C++中的变量声明格式为 `<变量类型> <变量名>`。
  - > Golang 将类型放到变量名后的原因： 为了避免像 C 语言中那样含糊不清的声明形式，例如：int* a, b;。在这个例子中，只有 a 是指针而 b 不是。如果你想要这两个变量都是指针，则需要将它们分开书写
- Golang 和 C++ 都支持多变量声明
  - 在Golang中，被赋值的元素统一在等号的右边。

```go
var a, b, c int
var d, e, f int = 1, 2, 3
```

- 在Golang中，交换两个变量的值非常方便，不需要使用中间变量。

```go
a, b = b, a
```


```cpp
int a, b, c;
int d = 1, e = 2, f = 3;
```
- 在Golang中变量如果没有被显示初始化，会被赋予`零值`， 所有的内存在 Go 中都是经过初始化的。
  
| 数值类型 | 字符串类型 | 布尔类型 | 指针类型 | 接口类型 | 切片类型 | 映射类型 | 通道类型 | 函数类型 |
|---|---|---|---|---|---|---|---|---|
| 零值 | 0 | "" | false | nil | nil | nil | nil | nil |

- Golang 中的`变量类型`不是必须的，当变量能够被编译器推断出来时，可以省略变量类型。

```go
var a = 1                
var b = true
var c = "Hello, World!"
```

在Golang中，还可以使用`:=`来声明并初始化变量，这种方式只能在函数内部使用。

```go
a := 1
b := true
c := "Hello, World!"
```

Golang中可以使用`因式分解var关键字`来声明多个变量。

```go
var (
    vname1 v_type1
    vname2 v_type2
)
```
> 这种因式分解关键字的写法一般用于声明全局变量。

作用域
: Golang 中的变量的作用域和 C++ 中的变量作用域是一样的，指一个变量的作用范围。

局部变量
: 在函数体内声明的变量称之为局部变量。局部变量只能在函数内部使用。

全局变量
: 在函数体外声明的变量称之为全局变量。全局变量可以在整个包甚至外部包（被导出后）使用。

变量隐藏
: Golang 中允许在函数体内声明与外部变量同名的变量，此时，函数体内的变量会被优先考虑。这和C++中的变量隐藏是一样的。

```go
package main

import "fmt"

var a = "G"

func main() {
    var a = "O"
    fmt.Println(a) // O
}
```

### 2.6. 常量

- Golang 中的常量使用`const`关键字声明，C++中的常量也是使用`const`关键字声明。

常量的定义格式：const identifier [type] = value

```go
const Pi = 3.14159
const a, b = 1, 2
```
- 在Golang中，常量可以使显示类型定义，也可以隐式类型定义。
  - 显式类型定义： const b string = "abc"
  - 隐式类型定义： const b = "abc"
- 和变量一样，常量也可以使用`因式分解关键字`的方式定义多个常量。

```go
const (
    vname1 v_type1 = v_value1
    vname2 v_type2 = v_value2
)
```

### 2.7. 值类型和引用类型

- Golang 中的`值类型`包括：基本数据类型、数组和结构体。
- Golang 中的`引用类型`包括：指针、切片、映射、通道和接口。

### 2.8. 字符串
- 字符串拼接， Golang 使用 `+` 进行字符串拼接，和 C++ 一样。
- 在 Golang 中，获取字符串中的某个字符，可以使用 `str[index]` 的方式，和 C++ 一样。

### 2.9. 指针
- Golang 中的指针移动是不支持的
  - Golang 中的指针只支持 `&` 和 `*` 两个操作符，不支持 `++` 和 `--` 操作符。

### 2.10. 控制语句

Go 完全省略了 if、switch 和 for 结构中条件语句两侧的括号，相比 Java、C++ 和 C# 中减少了很多视觉混乱的因素，同时也使你的代码更加简洁。（个人并不觉得，还是有括号看着舒服）

#### if-else

```go
if condition1 {
	// do something	
} else if condition2 {
	// do something else	
} else {
	// catch-all or default
}
```
- 关键字 if 和 else 之后的左大括号 { 必须和关键字在同一行，如果你使用了 else-if 结构，则前段代码块的右大括号 } 必须和 else-if 关键字在同一行。这两条规则都是被编译器**强制规定**的。在C++中没有这种强制规定（但我一般就这么写的）

- if 语句中可以定义一个变量，这个变量的作用域只在整个 if-else 语句块中。
  - 这在C++17中也是可以的。

```go
if v := math.Pow(x, n); v < lim {
    return v
}
```

```cpp
if (int v = math::pow(x, n); v < lim) {
    return v;
}
```


#### switch

```go
switch var1 {
	case val1:
		...
	case val2:
		...
	default:
		...
}
```

- Golang 中的 switch 语句不需要写 break，一旦匹配成功，自动终止。但C++中需要写 break，否则会继续执行下一个 case 语句。

#### for

- Golang 中的 for 循环只有一种形式，没有 while 和 do-while 循环。

基于计数器的循环
: 和 C++ 一样，Golang 中的 for 循环可以使用计数器的方式来实现。只是没有括号而已。

```go
for i := 0; i < 10; i++ {
    fmt.Println(i)
}
```

基于条件判断的循环
: Golang 中的 for 循环可以只写一个条件和 别的语言的 while 效果相同

```go
for sum < 1000 {
    sum += sum
}
```

for-range 循环 
: Golang 中的 for-range 循环可以用于遍历数组、切片、通道或映射。和C++中的 for-each 循环效果相同。

- 语法上很类似其它语言中 foreach 语句，但依旧可以获得每次迭代所对应的索引。一般形式为：for ix, val := range coll { }。

```go
for i, v := range arr {
    fmt.Println(i, v)
}
```